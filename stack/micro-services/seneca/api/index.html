<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><title>Your Stack Your Way</title><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0"><link href="//fonts.googleapis.com/" rel="dns-prefetch"><link href="//fonts.googleapis.com/css?family=Droid+Serif:200,400,700,400italic" rel="stylesheet"><link href="/assets/css/main.css" rel="stylesheet" media="only all"><meta name="description"></head><body><div class="__page-container"><nav data-scroll-header="" data-js="trigger-overlay" id="trigger-overlay" class="SiteNav engineer engineer"><div class="SiteNav__bar"><a class="_SiteNav__logo SiteNav__a" href="/"><div class="LogoContainer"><?xml version="1.0" encoding="UTF-8" standalone="no"?><?xml-stylesheet href="../main.css" type="text/css"?><!DOCTYPE svg PUBLIC “-//W3C//DTD SVG 1.1//EN” “http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd”><svg viewbox="0 0 207 219" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:sketch="http://www.bohemiancoding.com/sketch/ns"><title>logo</title><description>dreamineering logo created with Sketch</description><defs></defs><g id="icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="256" transform="translate(-22.000000, -18.000000)" fill="#000000"><g id="logo" transform="translate(21.500000, 17.500000)"><path class="bd-logo-svg" d="M69.3045933,107.986937 L90.0502585,17.6043327 L0.660870037,17.6043327 L21.0954805,107.986937 L69.3045933,107.986937 Z M69.3045933,107.986937" id="dream"></path><path class="bd-logo-svg" d="M57.5705067,219.34676 L57.5705067,128.964156 L146.959895,174.155458 L57.5705067,219.34676 Z M57.5705067,219.34676" id="engine"></path><g id="reality" transform="translate(117.552961, 0.540079)"><path class="bd-logo-svg" d="M62.0906971,107.041504 C67.1464577,111.993692 69.6743002,118.115055 69.6743002,125.405775 C69.6743002,132.834057 67.1113488,139.196147 61.9853693,144.492237 C56.8593897,149.788327 50.6451104,152.436332 43.342345,152.436332 C36.1800174,152.436332 30.0710649,149.788327 25.0153043,144.492237 C19.9595436,139.196147 17.4317012,132.834057 17.4317012,125.405775 C17.4317012,117.977494 19.9244347,111.821742 24.9099764,106.938334 C29.8955182,102.054927 36.0395796,99.6132597 43.342345,99.6132597 C50.7855482,99.6132597 57.0349364,102.089316 62.0906971,107.041504 Z M62.0906971,107.041504" id="?"></path><path class="bd-logo-svg" d="M26.9075929,91.057101 L26.9075929,87.7258314 C26.9075929,82.0568004 27.5008197,77.4544345 28.6872911,73.9185956 C29.8737625,70.3827567 31.6399605,67.1537952 33.9859381,64.2316143 C36.3319157,61.3094333 41.6035449,56.1664721 49.8009838,48.8025761 C54.1693558,44.9452973 56.3535091,41.4095115 56.3535091,38.1951124 C56.3535091,34.9807134 55.4771513,32.4822862 53.7244094,30.6997559 C51.9716675,28.9172255 49.3156293,28.0259737 45.7562151,28.0259737 C41.9271482,28.0259737 38.7587777,29.3993781 36.2510086,32.1462282 C33.7432394,34.8930782 32.1388306,39.6853831 31.4377338,46.5232864 L0.0503286328,42.3153669 C1.12893902,29.8084326 5.32197398,19.7416703 12.6295593,12.1147781 C19.9371447,4.48788594 31.1410419,0.674497044 46.2415873,0.674497044 C57.9984405,0.674497044 67.4900695,3.33364179 74.716759,8.65201107 C84.5321135,15.8405761 89.4397171,25.4251858 89.4397171,37.4061275 C89.4397171,42.3738351 88.1723689,47.1661399 85.6376345,51.7831858 C83.1029001,56.4002316 77.925648,62.0399562 70.1057227,68.7025287 C64.6587403,73.3780182 61.2207212,77.1329643 59.7915625,79.9674798 C58.3624037,82.8019953 57.6478351,86.4984987 57.6478351,91.057101 L26.9075929,91.057101 Z M26.9075929,91.057101" id="?"></path></g></g></g></g></svg></div></a> <a class="_SiteNav__returnlink u-linkBorderBottom" href="../">engineer</a></div></nav><header class="u-z200 u-sizeFullHeight Banner engineer engineer" role="banner"><div class="u-pullBottom"><div class="_site-width"><div class="_copy-width"><h1>Seneca Core API</h1></div></div></div><div class="u-bottomRight"><a class="u-linkClean" href="#content" data-scroll=""><i class="icon ion-chevron-down"></i></a></div></header><div id="content" class="__content-container"><div class="__content content" role="main"><section class="__section"><div class="_site-width "><div class="_copy-width _copy-- markdown"><p>use( name, options )<br>Register a plugin. The plugin will usually add some actions to the Seneca instance. You can optionally provide some options for the plugin (for example, database connection details).</p><p>ready( ready )<br>Provide a callback to be executed once all the plugins registered up this point are initialized. You use this to wait for database connections to establish.</p><p>add( pattern, action )<br>Add a new action to the Seneca instance. The action is triggered when an object matching the pattern is submitted to Seneca using the act method.</p><p>act( object, callback )<br>Invoke an action using an object. The action pattern that matches the object in the most specific manner will be invoked.</p><p>make( entity-canon, properties )<br>Create an instance of a data entity. The entity-canon defines the kind of entity to create (‘product’, ‘sys/user’, …), and the properties (optional) define the values of some of the entity fields.</p><p>export( name )<br>Returns a reference to a named object. These are provided by some plugins so that you can integrate into other systems (for example, providing a middleware function for express).</p><p>log.level( entry0, entry1, … )<br>Create a log entry using the Seneca logging system. Use this inside plugins as it handles all the context information (time, which plugin, etc) for you. Levels are debug, info, warn, error, fatal.</p><p>pin( pin-pattern )<br>Creates a convenience object that can call actions directly using method calls.</p><p>close( done )<br>Calls the close:name action on all plugins that have registered this action. You can use this to close database connections after tests complete to ensure the process ends.</p><p>Detailed Method Descriptions<br>use<br>The use method loads and registers plugins. You can refer to built-in plugins by name directly, for example: echo, options, mem-store, etc. External plugins need to be installed with npm install first, and then you can refer to them using their npm module name. See, for example, the seneca-user plugin. As a convenience, you can omit the seneca- prefix on standard plugins.</p><p>Example: registering the built-in mem-store plugin with custom options<br>var seneca = require(‘seneca’)()<br>seneca.use( ‘mem-store’, {web:{dump:true}} )<br>The second argument to the use method is an options object containing configuration properties specific to the plugin. Refer to the documentation for each plugin to find out how to use them. If you’re using the options plugin, properties in the options argument will override options loaded externally.</p><p>To use Seneca for your own business logic, the best approach is to define your own plugin (or plugins), and register these as needed with the use method. Your business logic actions can then be logged and extended as needed.</p><p>Example: creating your own (mini) plugin:<br>// file: mini.js<br>module.exports = function( options ) {<br>this.add( {foo:’bar’}, function( args, done ){<br>done( null, {say:options.say})<br>})<br>}</p><p>// file: app.js<br>var seneca = require(‘seneca’)()<br>seneca.use( ‘mini’, {say:’hello’} )<br>seneca.act( {foo:’bar’}, function( err, out ){<br>// prints ‘hello’<br>console.log( out.say )<br>})<br>method signatures<br>use( name, options )<br>name: string, reference to plugin, used to build argument to require function<br>options: object, optional, contents depend on plugin<br>This method is synchronous (the Node.js built-in require function, used to load plugins, is synchronous itself). Add an init:name action for your plugin if you need to do asynchronous initialization.</p><p>ready<br>Each plugin can optionally define an action with the pattern init:name. If this action is defined, it will be called in series, in order, for any plugins that define it. You can ensure that database connections and other external dependencies are in place before using them. Just a reminder: the order of plugin registration is significant!</p><p>This method takes a callback function with the standard signature function( err, result ) { … } as an argument. Inside this callback is where you would normally complete the initialisation of other parts of your app, such as setting up express.</p><p>Example: waiting for the database connection before inserting data<br>var seneca = require(‘seneca’)()<br>seneca.use( ‘mongo-store’, { host:…, port:…, name:… } )<br>seneca.ready( function( err ) {<br>if( err ) return console.log(err);</p><p>seneca.make$(‘product’,{name:’Apple’,price:1.99}).save$()<br>})<br>You can call ready more than once. If you need to register additional plugins dynamically (this is perfectly fine!), you can call ready again to wait for the new plugins to initialize.</p><p>method signatures<br>ready( ready )<br>ready: function, callback with signature function(err), called after plugins initialize.<br>Seneca also emits a ‘ready’ event, which you can use instead of this function:</p><p>seneca.on(‘ready’, function(err){ … })<br>add<br>Add an action to the Seneca instance. You provide a key/value pair pattern that Seneca will match against objects that are submitted using the add method. When an object is submitted, Seneca will check the object’s top-level properties in alphabetical order to see if there is a matching action.</p><p>The action is a function that accepts two arguments. The first is the object that was submitted, and the second is a callback tat you should call once your action has completed it’s work. The callback has the standard signature function( err, result ). The callback must always be called, especially to report errors. The action result is optional, and you do not have to supply one if it does not make sense for your action.</p><p>Example: defining an action<br>seneca.add( {foo:’bar’}, function( args, done ){<br>done( null, { zoo:args.zoo } )<br>})</p><p>seneca.act( {foo:’bar’, zoo:’qaz’}, function( err, out ){<br>// prints ‘qaz’<br>console.log( out.zoo )<br>})<br>You can define actions at any time, any where. They don’t need to be associated with a plugin. Actions defined inside a plugin do get some logging meta-data however, so they’re easier to manage in the long run.</p><p>method signatures<br>add( pattern, action )<br>pattern: object or string (key/value format)<br>action: function( args, done ) (action signature)<br>notes</p><p>add( pattern, paramspec, action )<br>pattern: object or string (pattern format)<br>paramspec: object (parameter specification)<br>action: function( args, done ) (action signature)<br>notes</p><p>act<br>…TODO…</p><p>method signatures<br>act( input, callback )<br>input: object, properties to be matched against previously added action patterns<br>callback: function( error, result ), optional (result signature)<br>notes</p><p>act( keyvaluepairs, object, callback )<br>keyvaluepairs: string (key/value format)<br>input: object, properties to be matched against previously added action patterns<br>callback: function( error, result ), optional (result signature)<br>notes</p><p>make<br>…TODO…</p><p>method signatures<br>make( entity-canon, properties )<br>entity-canon: string, (entity canon format)<br>properties: object, optional, initial values of some of the data fields<br>notes</p><p>export<br>…TODO…</p><p>method signatures<br>export( name )<br>name: string, reference to plugin provided object<br>notes</p><p>pin<br>…TODO…</p><p>method signatures<br>pin( pin-pattern )<br>pin-pattern: object or string (pin pattern format)<br>notes</p><p>log<br>…TODO…</p><p>method signatures<br>log.level( entry0, entry1, … )<br>entryX: JavaScript value, converted to string<br>notes</p><p>close<br>…TODO…</p><p>method signatures<br>close( done )<br>done: function, optional, callback with signature function(err), called after all close actions complete.<br>notes</p></div></div></section></div></div><div data-js="SiteNavOverlay" class="SiteNavOverlay SiteNavOverlay--drmg"><nav class="SiteNavOverlay-nav"><ul><li><a class="u-linkClean" href="/values">Values</a></li><li><a class="u-linkClean" href="/archetypes">Archetypes</a></li><li><a class="u-linkClean" href="/flow">Flow</a></li><li><a class="u-linkClean" href="/engineer">Stack</a></li></ul></nav></div><footer data-js="footer" class="__Pagefooter Pagefooter" role="contentinfo"><div class="u-cf u-paletteBody"><div class="_site-width"><p class="u-marginAn u-paddingAl">&copy; 2014 stackmates <span class="u-hidden"><span class="g-plusone" data-annotation="none"></span></span></p></div></div></footer></div><script src="/assets/js/app.js"></script><script type="text/javascript">
      (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/platform.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
    </script><script>
       // ensure all non-essential stuff is loaded after window.load
        // http://www.feedthebot.com/pagespeed/defer-loading-javascript.html
        if (window.addEventListener)
          window.addEventListener("load", afterWindowLoad, false);
        else if (window.attachEvent)
          window.attachEvent("onload", afterWindowLoad);
        else
          window.onload = afterWindowLoad;
    
        function afterWindowLoad() {
        }
    
    </script></body></html>